# -*- coding: utf-8 -*-
import matplotlib.pyplot as plt
import sys
import os

import numpy as np
import matplotlib as mpl 
mpl.use('TkAgg')       

def draw():
    x = [0.001, 0.005, 0.01, 0.05, 0.1]
    # data = [[[0, 11152036.830821123], [13295027.550742393, 15095.60840286135], [10788244.659911856, 8722368.06672861], [9708644.838698318, 13195.480671889238], [9796356.607, 14925.97487774658]], [[0, 9589267.821798991], [7689125.364277976, 53430.48721318294], [4918356.144511858, 10828153.6224819], [3986481.5396779655, 59036.92870845212], [4492085.171054249, 55775.75036226533]], [[0, 8280609.243724975], [4559701.97306779, 103496.41481577075], [3213718.9855762804, 11263080.849703908], [3572345.328822037, 94088.25299545271], [3137029.364211856, 100476.65924990615]], [[0, 9050029.038133888], [2313391.940862404, 498011.8499142118], [1442188.1471040533, 10954099.798517007], [1336401.1179779642, 479450.824133711], [1508349.0536979658, 520640.6707268305]], [[0, 12322782.07516959], [1406585.2110642218, 1027732.6904383685], [888078.4456060709, 9659547.3703714], [1077384.968503892, 981832.5058445707], [940711.6057738943, 823826.142428313]]]
    # data = [[[0, 9400108.034653146], [15741426.78356611, 14134.01745676701], [10401494.420088146, 9883341.521529516], [10778468.186867783, 14049.306814341466], [10315620.332823716, 14592.265697663814]], [[0, 10100983.463317329], [7175185.72047796, 57745.57287805946], [5494364.000420362, 8864237.608870842], [5318083.903233891, 54603.50010287709], [5024559.828464427, 63088.663967937166]], [[0, 9239514.57872614], [5138313.071010167, 97803.53185257927], [3242405.8337542503, 9921905.923190117], [2979227.5122779645, 109270.03051621761], [3600064.5093779634, 91160.79897533082]], [[0, 9649533.631959928], [2036370.7619779545, 514514.27887148253], [1554975.8139522595, 9671724.198273903], [1366297.0485799997, 418846.36645484477], [1561737.8729376083, 457935.03394808655]], [[0, 9906825.336391442], [1448856.034197988, 951596.3639331083], [1061034.129749996, 11996286.831751013], [1057944.758925573, 961068.2595993741], [1036723.0838920361, 940727.5055484431]]]
    # data = [[[0, 1000010.8439576376], [16102122.445911856, 4084.9844795235604], [10967060.564433895, 1080684.196747199], [11278652.811955929, 4414.494029729944], [9167951.896088142, 4583.058234962782]], [[0, 853500.3155241482], [7393011.217545748, 8353.545449847234], [4964434.173186464, 1049090.5655029353], [5219138.588244071, 8939.963423396188], [4472042.088820355, 9112.231688191328]], [[0, 1005852.6382321911], [4706563.880588143, 14592.325830366597], [3313441.360522039, 1005780.2517245183], [3309649.067722035, 14792.576090391434], [3434425.627022038, 14845.086750049186]], [[0, 1043939.6375099422], [2632604.020308156, 46297.578277182205], [1490659.1468661306, 924451.155447473], [1600248.894706108, 51064.14367431778], [1553071.522119999, 52128.23041555495]], [[0, 1080388.707929728], [1267732.550989996, 107273.4659690075], [996979.1160781261, 1079842.175771119], [964999.2371038924, 102101.84122900516], [996657.5172040701, 120288.02288350747]]]
    # data = [[[0, 983636.4161866915], [10652972.90586779, 966584.2345328425], [16335640.775911856, 4534.62783924289], [9832034.957044072, 3349.4374612951406], [11341462.428088143, 3864.417600643116]], [[0, 891732.8545826745], [5089501.0838983245, 874415.6617285706], [6908594.82723389, 7590.488149816885], [4917573.61129832, 10479.216459286565], [4730182.852566107, 8709.712091428151]], [[0, 1009359.4210232977], [3725549.3956355704, 918672.963031249], [5570997.717766092, 11919.558560811221], [3098218.921755929, 12130.056016337494], [3140774.334276284, 12487.93165654763]], [[0, 924952.4659089189], [1437899.0940040455, 1079001.9455656102], [2118746.7813799963, 59743.54080338237], [1508233.450928144, 53816.18226546559], [1529275.6433159302, 53564.22908819414]], [[0, 936608.3987137121], [958890.2416422023, 938922.3838888041], [1276283.053899984, 100327.64912552341], [930569.2556101801, 122136.63491449025], [1039064.6695520356, 110100.55308867418]]]
    # data = [[[0, 9456405.215020262], [11066741.047044067, 11313849.183201944], [15048828.581433898, 16548.131852065857], [10074689.401477963, 13997.493503170044], [11979129.740566107, 16011.369822055527]], [[0, 10012580.164722554], [5167902.008600001, 9253051.268781396], [7015534.120745747, 57172.0342328393], [5054153.773444071, 46670.604348461646], [5336033.336766108, 54062.48017097608]], [[0, 9670338.915921316], [3631120.138798326, 8125348.552020997], [4429774.480376277, 117787.68825985547], [3078167.055266108, 106997.39722948479], [3543446.0733101773, 106155.15477519548]], [[0, 8138882.690427083], [1296228.1675722273, 11235672.997918297], [1885542.121274245, 583724.353885405], [1431958.7171359283, 493637.5026379252], [1548121.482322036, 541201.4828158966]], [[0, 10421175.645836258], [1083162.46955611, 8829929.599579345], [1542021.0770559383, 1140833.6587089836], [915714.8002816807, 814043.8127656818], [976096.5524118568, 879806.2457185262]]]
    # data = [[[0, 11261741.717054239], [9640972.639823718, 9496216.715036402], [16335767.174477963, 15324.42229765225], [10452108.850220356, 13692.115776455124], [9950326.49013221, 12696.287297073948]], [[0, 10864476.097832926], [4600711.57256611, 9542124.623336723], [7237883.886633906, 50713.23307989078], [4167091.4246542477, 50090.26699251024], [5089726.178477965, 52846.00046298311]], [[0, 8592283.5308555], [3011671.6286457432, 7621522.676645962], [5946917.605688136, 101563.73336441853], [3625378.3887661085, 114862.5859992749], [2895965.4914220334, 88760.084652975]], [[0, 9296700.223674076], [1538656.0115595954, 8431168.06468362], [2158213.7402142556, 562647.9467241147], [1582037.69708, 469035.41336647724], [1592868.8561881422, 427429.5424535286]], [[0, 8581605.894567875], [918367.6429818821, 11171348.65581385], [1404623.5292618745, 991177.6387829591], [963877.1343381428, 1158177.809979322], [1153592.154320178, 873368.3508699514]]]
    data = [[[0, 9459178.2982832], [10734076.667349165, 9484037.600258015], [14337644.196500001, 14205.130743288617], [10419379.28426102, 13395.466523812092], [9710089.728544071, 14450.222367711825]], [[0, 8639471.120116273], [4857234.906844078, 10707194.046100551], [6448510.921583056, 57482.13014513498], [4876880.225583053, 62438.95958981225], [4618266.821305091, 63990.2719186588]], [[0, 10603860.707115343], [3264256.061277125, 9509593.811369423], [5062836.355600003, 109146.5246373901], [3296824.1939050895, 102142.87789574516], [3529420.518077963, 93749.02077908251]], [[0, 9976515.766957302], [1587678.4912959433, 8708585.65026655], [2193162.6951910164, 485236.3473014038], [1539517.2487361082, 487377.25065544544], [1422062.6170199995, 413781.23353788554]], [[0, 9458404.411955815], [905372.679165075, 10139656.393050347], [1491165.6269928915, 970633.2002525746], [1086417.9906349108, 1145860.515959889], [1085017.1046720343, 904933.4078354856]]]
    
    bar_width=0.14
    
    plt.figure(figsize = (13, 7))

    sample_y = [[] for i in range(5)]
    dp_y = [[] for i in range(5)]
    total_y = [[] for i in range(5)]
    for xindex in range(5):
        for xmethod in range(5):
            sample_y[xmethod].append(data[xindex][xmethod][0])
            dp_y[xmethod].append(data[xindex][xmethod][1])
            total_y[xmethod].append(data[xindex][xmethod][0] + data[xindex][xmethod][1])
    total_y = np.array(total_y)
    sample_y = np.array(sample_y)
    index = np.arange(5)
    print (index)
    print (sample_y[0][0], sample_y[1][0], sample_y[2][0])
    print (sample_y[index][0])
    print (" -> ", sample_y[0][0], sample_y[1][0], sample_y[0][1])
    # dpcolorlist = ['green'] * 5
    # samplecolorlist = ['red'] * 5
    dpcolorlist = [plt.cm.tab20c(0), plt.cm.tab20c(4), plt.cm.tab20c(8), plt.cm.tab20c(12), plt.cm.tab20c(16)]
    samplecolorlist = [plt.cm.tab20c(1), plt.cm.tab20c(5), plt.cm.tab20c(9), plt.cm.tab20c(13), plt.cm.tab20c(17)]
    for xmethod in range(5):
        print (sample_y[xmethod])
        plt.bar(index + xmethod * bar_width, total_y[xmethod], color=dpcolorlist[xmethod], width=bar_width)
        plt.bar(index + xmethod * bar_width, sample_y[xmethod], color=samplecolorlist[xmethod], width=bar_width, hatch='///')

    # plt.yscale('log')
    plt.ylabel ("Absolute Error", fontsize=17)
    plt.xlabel ("Sample rate", fontsize=17)
    plt.legend(('Exact Dp.', 'Exact Sp.', 'Shuffle Dp.', 'Shuffle Sp.', 'Poisson Dp.', 'Poisson Sp.', 'WR Dp.', 'WR Sp.', 'WoR Dp.', 'WoR Sp.'), ncol = 5, fontsize=13)
    plt.xticks(index + 2 * bar_width,('0.1%', '0.5%', '1%', '5%', '10%'), fontsize=13)
    plt.yticks([0.5e7, 1e7, 1.5e7, 2e7], (r'$0.5\times10^7$', r'$1.0\times10^7$', r'$1.5\times10^7$', r'$2.0\times10^7$'), rotation=60, fontsize=13)
    plt.savefig('error_0.pdf')

draw()